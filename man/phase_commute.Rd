% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/commute.R
\name{phase_commute}
\alias{phase_commute}
\title{Commute-disruption penalty per district}
\usage{
phase_commute(plans, shp, current, schools_idx, pop = NULL)
}
\arguments{
\item{plans}{A \code{redist_plans} object or an integer matrix (n_units Ã— n_plans)
of district labels (1..D).}

\item{shp}{A \code{redist_map} or an \code{sf} with one row per unit (used only to infer
population if \code{pop} is \code{NULL}).}

\item{current}{Integer vector (length n_units): district assignment under the
current/old plan (1..D).}

\item{schools_idx}{Integer vector (1-based) of row indices that correspond to
school units in \code{shp}/the units table.}

\item{pop}{Optional numeric vector (length n_units) of unit populations.
If \code{NULL}, attempts to infer from common column names in \code{shp}; falls back
to all ones.}
}
\value{
A numeric vector of length \code{ndists * nplans}, i.e., the district-by-plan
scores flattened column-major. Use \code{by_plan()} to get one value per plan.
}
\description{
For each plan and district, computes
\deqn{ \log\!\big(1 + \text{avg extra commute time per person}\big) }
where a unit's "zoned" school is one that lies in the same district
(under the current plan vs the proposed plan).
}
\examples{
# scores_d_by_p <- phase_commute(plans, map, current, school_rows)
# plan_scores   <- by_plan(scores_d_by_p, plans)
}
